{% extends "layout.html" %}

{% block body %}
    {% include 'nav.html' %}
    {% if error %}
        <div class="error-message">
            {{ error }}
        </div>
    {% endif %}
    <form action="/withdraw" method="post">
        <input type="date" class="input" placeholder="Date" name="date" required="">
        <input type="number" min="0" class="input" placeholder="Amount" name="amount" required="">

        <input type="text" id="searchInput1" placeholder="Search Currency" class="input">
        <select name="currency" id="CurrencySelect1" class="input" required="">
            <option disabled selected>Currency</option>
            {% for currency in currency_all %}
                <option value="{{ currency }}">{{ currency }}</option>
            {% endfor %}
        </select>
        <button class="btn btn-primary" type="submit">Submit</button>
    </form>
    <script>
        const searchInput = document.getElementById('searchInput');
        const currencySelect1 = document.getElementById('CurrencySelect1');

        const originalOptions1 = [...currencySelect1.options];

        function filterOptions(searchInput, currencySelect, originalOptions) {
            const searchText = searchInput.value.toLowerCase();
            currencySelect.innerHTML = '';

            // Filter from original options
            const filteredOptions = originalOptions.filter(option => {
                const optionText = option.textContent.toLowerCase();
                return optionText.includes(searchText);
            });

            // Add filtered options to the select dropdown
            filteredOptions.forEach(option => {
                currencySelect.appendChild(option);
            });

            // If no options match the filter, re-add the default disabled option
            if (filteredOptions.length === 0) {
                const defaultOption = document.createElement('option');
                defaultOption.disabled = true;
                defaultOption.selected = true;
                defaultOption.textContent = 'No Match';
                currencySelect.appendChild(defaultOption);
            }
        }

        // Event listeners for the input fields
        searchInput1.addEventListener('input', () => {
            filterOptions(searchInput1, currencySelect1, originalOptions1);
        });
    </script>
{% endblock %}